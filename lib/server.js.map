{"version":3,"sources":["../src/server.js"],"names":[],"mappings":";;AACA;;AACA;;;;AACA;;;;AACA;;AAGA;;;;AACA;;;;;;AAEA,IAAM,SAAS,wBAAf;AACA,OAAO,GAAP,CAAW,+BAAX;;AAEA,IAAM,QAAQ,6BAAI,0BAAM,MAAV,EAAkB,0BAAM,MAAxB,EAAgC,0BAAM,OAAtC,EAA+C,oBAAM,IAArD,EAA2D,oBAAM,IAAjE,CAAd;;;;;AAMA,OAAO,GAAP,CAAW,MAAX,EAAmB,2DAChB,IADgB,CACX,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,IAAhB,EAAyB;AAC7B,MAAI,KAAJ,CAAU,KAAK,SAAL,CAAe,GAAf,CAAV;AACD,CAHgB,EAIhB,KAJgB,CAIV,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,IAAhB,EAAyB;AAC9B,MAAI,KAAJ,CAAU,KAAK,SAAL,CAAe,GAAf,CAAV;AACD,CANgB,EAOhB,UAPgB,EAAnB;;;;;AAaA,OAAO,MAAP,eAAoB,YAAM;;AAExB,UAAQ,GAAR;AACD,CAHD","file":"server.js","sourcesContent":["\nimport 'babel-polyfill';\nimport express from 'express';\nimport session from 'express-session';\nimport { port, mobileSignupEvent,\n  wxentSignupConfig as wxcfg,\n  redisConfig as redis } from './config';\nimport API from 'wxent-api-redis';\nimport wechat from 'wechat-enterprise';\n\nconst server = express();\nserver.use(session());\n\nconst wxapi = API(wxcfg.corpId, wxcfg.secret, wxcfg.agentId, redis.host, redis.port);\n\n\n//\n// Register server-side rendering middleware\n// -----------------------------------------------------------------------------\nserver.get('/wxe', wechat(wxcfg)\n  .text((msg, req, res, next) => {\n    res.reply(JSON.stringify(msg));\n  })\n  .event((msg, req, res, next) => {\n    res.reply(JSON.stringify(msg));\n  })\n  .middleware()\n);\n\n//\n// Launch the server\n// -----------------------------------------------------------------------------\nserver.listen(port, () => {\n  /* eslint-disable no-console */\n  console.log(`The server is running at http://localhost:${port}/`);\n});\n"]}